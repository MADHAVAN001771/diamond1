<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>View Sold History</title>
<link rel="stylesheet" href="style.css">
</head>

<body>

<div class="container">
  <h2 class="title">ðŸ“… Sold History</h2>

  <!-- DATE SELECT -->
  <div class="top-bar">
    <label><b>Select Date:</b></label>
    <input type="date" id="historyDate">
  </div>

  <!-- SOLD TABLE -->
  <table class="history-table">
    <thead>
      <tr>
        <th>Cent / Item</th>
        <th>Sold Pieces</th>
        <th>Sold Weight</th>
      </tr>
    </thead>
    <tbody id="historyBody"></tbody>
  </table>
</div>

<script>
const body = document.getElementById("historyBody");
const ROWS = 25;

// CREATE ALL PRODUCTS ROWS (20 CENTS + 5 ITEMS)
for (let i = 1; i <= ROWS; i++) {
  let label = i <= 20 ? `${i} Cent` : `Item ${i - 20}`;
  body.innerHTML += `
    <tr>
      <td>${label}</td>
      <td id="p${i}">0</td>
      <td id="w${i}">0.000</td>
    </tr>
  `;
}

// WHEN DATE IS SELECTED
document.getElementById("historyDate").addEventListener("change", function () {

  const selectedDate = this.value;
  const history = JSON.parse(localStorage.getItem("soldHistory")) || {};

  // RESET TABLE
  for (let i = 1; i <= ROWS; i++) {
    document.getElementById("p" + i).innerText = 0;
    document.getElementById("w" + i).innerText = "0.000";
  }

  // IF NO DATA FOR DATE
  if (!history[selectedDate]) {
    alert("No sold data for this date");
    return;
  }

  // LOAD DATA FOR THAT DATE
  history[selectedDate].forEach((item, index) => {
    document.getElementById("p" + (index + 1)).innerText = item.pieces;
    document.getElementById("w" + (index + 1)).innerText =
      Number(item.weight).toFixed(3);
  });
});
</script>

</body>
</html>
